copied from https://github.com/pikapkg/esm-hmr
copied at 85216b54920876eac7320a0a49c629de66cf3a73
we should switch to esm-hmr from npm if they publish non-typescript source
if we do switch to it, we can remove ws from our deps

I did add the ability to send error messages. Gotta reconcile that if we switch back to npm
